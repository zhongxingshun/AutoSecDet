# 研发设计评审记录 v1.0

> 项目名称: 自动化安全检测平台 (AutoSecDet)
> 评审类型: 技术设计评审
> 评审日期: 2026-01-28
> 评审人员: 高级架构师

---

## 评审信息

| 项目 | 内容 |
|------|------|
| 评审日期 | 2026-01-28 |
| 评审人员 | 高级架构师 |
| 需求基线 | SRS_v1.1 |
| 设计文档 | TDD_v1.0 |

---

## 评审维度检查

根据 SKILL.md 第 4 章定义的设计评审检查清单逐项审查：

| 检查项 | 评审结论 | 说明 |
|--------|---------|------|
| 架构设计满足非功能需求 | ⚠️ 部分满足 | 存在可用性、数据保留策略等缺失 |
| 模块职责清晰、边界明确 | ⚠️ 部分满足 | 部分模块边界模糊 |
| 接口设计规范、易于理解 | ⚠️ 部分满足 | 部分接口定义不完整 |
| 数据模型设计合理 | ⚠️ 部分满足 | 缺少审计日志表详细设计 |
| 安全设计完善 | ⚠️ 部分满足 | 缺少脚本安全执行机制 |
| 性能设计可达成目标 | ✅ 满足 | 性能目标与优化策略合理 |
| 技术风险已识别并有缓解措施 | ⚠️ 部分满足 | 部分SRS风险未在TDD中体现 |
| 技术选型有充分理由 | ✅ 满足 | 选型合理，理由充分 |

---

## 问题清单

### 🔴 阻塞问题 (必须解决)

| 问题ID | 问题描述 | 关联需求 | 建议修改 | 状态 |
|--------|---------|---------|---------|------|
| Q-001 | **缺少日志保留与清理机制设计** - SRS F-007 要求"执行日志保留 30 天"，SRS F-011 要求"历史记录默认保留 90 天"，但 TDD 中未设计任何数据清理策略或定时任务 | F-007, F-011 | 增加第 4.3 节"数据生命周期管理"，设计定时清理任务（如 Celery Beat），明确日志/历史记录的清理策略 | 待答复 |
| Q-002 | **缺少脚本安全执行机制** - SRS 4.3 安全需求要求"脚本安全：仅管理员可修改检测脚本"，SRS R-003 风险识别提到"脚本审核机制、沙箱执行"，但 TDD 第 11 节脚本执行引擎未设计任何沙箱隔离或权限限制机制 | SRS 4.3, R-003 | 在第 11 节增加脚本安全执行设计：1) 脚本执行用户隔离 2) 资源限制（CPU/内存/网络） 3) 脚本白名单校验 | 待答复 |
| Q-003 | **缺少断点续测/重试机制设计** - SRS R-004 风险识别要求"断点续测、重试机制"以应对网络不稳定，但 TDD 中完全未涉及此设计 | R-004 | 在第 3.3 节任务执行流程中增加：1) 任务中断后的恢复机制 2) 单用例执行失败的重试策略 | 待答复 |

### 🟡 重要问题 (建议解决)

| 问题ID | 问题描述 | 关联需求 | 建议修改 | 状态 |
|--------|---------|---------|---------|------|
| Q-004 | **审计日志表设计不完整** - SRS 4.3 安全需求要求"记录用户登录、用例修改等敏感操作"，TDD 4.1 数据模型中 `audit_logs` 表仅有 ER 图示意，缺少完整的 DDL 定义 | SRS 4.3 | 在第 4.2 节补充 `audit_logs` 表的完整 SQL 定义，包括字段类型、索引设计 | 待答复 |
| Q-005 | **用例删除接口设计与需求不符** - SRS F-005 仅要求"新增和编辑"用例，未提及删除功能；但 TDD 3.2.2 定义了 `DELETE /api/v1/cases/{case_id}` 接口 | F-005 | 确认是否需要删除功能：1) 若需要，应在 SRS 中补充需求 2) 若不需要，应从 TDD 中移除该接口 | 待答复 |
| Q-006 | **WebSocket 认证机制未说明** - TDD 3.2.1 定义了 `/ws/tasks/{task_id}` WebSocket 接口，但未说明如何进行身份认证（JWT 如何传递？） | - | 在第 5.1 节 API 规范中补充 WebSocket 认证方式（如 query parameter 或首条消息认证） | 待答复 |
| Q-007 | **缺少系统可用性保障设计** - SRS 4.2 要求"系统可用性 99%"、"故障恢复时间 < 1小时"，但 TDD 未设计任何高可用或故障恢复机制 | SRS 4.2 | 在第 2.3 节部署架构中补充：1) 数据库备份策略 2) 服务健康检查 3) 故障恢复流程 | 待答复 |
| Q-008 | **分类管理 API 定义过于简略** - TDD 3.2.2 中 `/api/v1/categories` 仅用一行 `GET/POST/PUT/DELETE` 概括，缺少详细的请求/响应格式 | F-006 | 补充分类管理各接口的详细定义，包括请求体、响应体、错误码 | 待答复 |
| Q-009 | **缺少前端状态管理方案说明** - TDD 10 目录结构中有 `stores/` 目录，但未说明使用何种状态管理方案（Redux/Zustand/Jotai？） | - | 在第 9 节技术选型中补充前端状态管理库的选型及理由 | 待答复 |

### 🟢 建议问题 (可选优化)

| 问题ID | 问题描述 | 建议修改 | 状态 |
|--------|---------|---------|------|
| Q-010 | **缺少 API 版本演进策略** | 建议在第 5.1 节补充 API 版本管理策略（如何处理 v2 版本？向后兼容策略？） | 待答复 |
| Q-011 | **缺少监控告警设计** | 建议增加第 7.3 节"监控与告警"，设计关键指标监控（任务执行成功率、API 响应时间等）和告警规则 | 待答复 |
| Q-012 | **缺少前端错误处理统一方案** | 建议在前端设计中补充全局错误处理机制（API 错误、网络错误、WebSocket 断连等） | 待答复 |
| Q-013 | **数据库连接池配置未说明** | TDD 7.2 提到"连接池"优化，建议明确连接池大小配置建议（如 min=5, max=20） | 待答复 |
| Q-014 | **缺少开发环境搭建指南** | 建议在 README 或单独文档中提供本地开发环境搭建步骤 | 待答复 |
| Q-015 | **脚本执行引擎缺少并发控制说明** | 第 11 节未说明同时执行多个脚本时的并发控制策略（Celery worker 数量？并发限制？） | 待答复 |

---

## 需求覆盖度检查

| 需求ID | 需求名称 | TDD 覆盖情况 | 备注 |
|--------|---------|-------------|------|
| F-001 | 目标地址输入 | ✅ 覆盖 | API 设计中包含 target_ip 参数 |
| F-002 | 检测用例选择 | ✅ 覆盖 | API 设计中包含 case_ids 参数 |
| F-003 | 任务执行控制 | ✅ 覆盖 | 包含 start/stop 接口，超时机制 |
| F-004 | 实时状态反馈 | ✅ 覆盖 | WebSocket 实时推送设计 |
| F-005 | 用例新增与编辑 | ✅ 覆盖 | 用例 CRUD API |
| F-006 | 用例分类管理 | ⚠️ 部分覆盖 | API 定义过于简略 |
| F-007 | 检测结果展示 | ⚠️ 部分覆盖 | 缺少日志保留策略 |
| F-008 | 报告导出 | ✅ 覆盖 | PDF/HTML 导出接口 |
| F-009 | 用户认证 | ✅ 覆盖 | JWT 认证设计完整 |
| F-010 | 账号管理 | ✅ 覆盖 | 用户管理 API |
| F-011 | 历史记录查询 | ⚠️ 部分覆盖 | 缺少保留策略设计 |

---

## 评审结论

- [ ] ✅ 通过
- [x] ⚠️ **条件通过** - 需处理 3 个阻塞问题后方可进入开发阶段
- [ ] ❌ 不通过

---

## 问题统计

| 问题类型 | 数量 |
|---------|------|
| 🔴 阻塞问题 | 3 |
| 🟡 重要问题 | 6 |
| 🟢 建议问题 | 6 |
| **合计** | **15** |

---

## 后续行动

| 序号 | 行动项 | 负责人 | 截止日期 |
|------|--------|--------|---------|
| 1 | 处理 Q-001~Q-003 阻塞问题，更新 TDD 至 v1.1 | 技术团队 | 待定 |
| 2 | 评估 Q-004~Q-009 重要问题，给出意见答复 | 技术团队 | 待定 |
| 3 | 完成修订后提交二次评审 | 技术团队 | 待定 |

---

## 评审签字

| 角色 | 姓名 | 意见 | 签字 | 日期 |
|------|------|------|------|------|
| 高级架构师 | | 条件通过 | | 2026-01-28 |
| 技术负责人 | | 待签字 | | |
| 测试负责人 | | 待签字 | | |
