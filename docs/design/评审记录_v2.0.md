# 研发设计评审记录 v2.0 (最终版)

> 项目名称: 自动化安全检测平台 (AutoSecDet)
> 评审类型: 技术设计二次评审
> 初审日期: 2026-01-28
> 二次评审日期: 2026-01-28
> 评审人员: 高级架构师

---

## 评审过程追溯

| 阶段 | 日期 | 文档版本 | 产出物 |
|------|------|---------|-------|
| 初审 | 2026-01-28 | TDD v1.0 | 评审记录_v1.0 |
| 答复 | 2026-01-28 | TDD v1.1 | 意见答复表_v1.0 |
| 二次评审 | 2026-01-28 | TDD v1.1 | 本评审记录 |

---

## 意见答复审查

### 答复统计

| 答复类型 | 数量 | 占比 |
|---------|------|------|
| ✅ 接受 | 11 | 73.3% |
| ❌ 拒绝 | 1 | 6.7% |
| ⏳ 延后 | 3 | 20.0% |
| **合计** | **15** | **100%** |

---

## 🔴 阻塞问题处理情况

| 问题ID | 问题描述 | 答复 | 二次评审意见 | 最终状态 |
|--------|---------|------|------------|---------|
| Q-001 | 缺少日志保留与清理机制设计 | ✅ 接受 | **修改正确** - TDD v1.1 第 4.3 节新增"数据生命周期管理"，包含完整的数据保留策略、Celery Beat 定时任务配置和清理任务实现代码，完全满足 SRS F-007 和 F-011 要求 | ✅ 关闭 |
| Q-002 | 缺少脚本安全执行机制 | ✅ 接受 | **修改正确** - TDD v1.1 第 11.3 节新增"脚本安全执行机制"，包含执行用户隔离、资源限制（CPU/内存/文件描述符/进程数）、脚本白名单校验，设计完善 | ✅ 关闭 |
| Q-003 | 缺少断点续测/重试机制设计 | ✅ 接受 | **修改正确** - TDD v1.1 第 3.4 节新增"容错与恢复机制"，包含断点续测流程、恢复接口、单用例重试策略、任务状态机，设计合理 | ✅ 关闭 |

**阻塞问题结论**: ✅ 所有 3 个阻塞问题已正确解决

---

## 🟡 重要问题处理情况

| 问题ID | 问题描述 | 答复 | 二次评审意见 | 最终状态 |
|--------|---------|------|------------|---------|
| Q-004 | 审计日志表设计不完整 | ✅ 接受 | **修改正确** - TDD v1.1 第 4.2.6 节补充了完整的 `audit_logs` 表 DDL，包含字段定义、索引设计和示例数据 | ✅ 关闭 |
| Q-005 | 用例删除接口设计与需求不符 | ✅ 接受（软删除） | **修改合理** - 采用软删除方案，在 cases 表增加 `is_deleted` 和 `deleted_at` 字段，既满足业务需求又保证数据可追溯性。建议后续在 SRS 中补充此需求 | ✅ 关闭 |
| Q-006 | WebSocket 认证机制未说明 | ✅ 接受 | **修改正确** - TDD v1.1 第 5.1 节补充了 WebSocket 认证方式（query parameter 传递 token）和服务端验证流程 | ✅ 关闭 |
| Q-007 | 缺少系统可用性保障设计 | ✅ 接受 | **修改正确** - TDD v1.1 第 2.4 节新增"可用性保障设计"，包含数据库备份策略、服务健康检查、故障恢复流程，RTO 目标明确 | ✅ 关闭 |
| Q-008 | 分类管理 API 定义过于简略 | ✅ 接受 | **修改正确** - TDD v1.1 第 3.2.2 节补充了分类管理 API 的详细定义，包含请求/响应示例和错误码 | ✅ 关闭 |
| Q-009 | 缺少前端状态管理方案说明 | ❌ 拒绝 | **理由合理** - 经核实，TDD v1.0 第 9 节技术选型中已明确"状态管理: Zustand 4.x"，评审人确实遗漏了此内容 | ✅ 关闭 |

**重要问题结论**: ✅ 所有 6 个重要问题已妥善处理

---

## 🟢 建议问题处理情况

| 问题ID | 问题描述 | 答复 | 二次评审意见 | 最终状态 |
|--------|---------|------|------------|---------|
| Q-010 | 缺少 API 版本演进策略 | ⏳ 延后 | **延后合理** - 首版无需版本演进策略，已记录到技术债务清单 | ✅ 关闭 |
| Q-011 | 缺少监控告警设计 | ⏳ 延后 | **延后合理** - 监控告警属于运维层面，计划在预发布阶段完善 | ✅ 关闭 |
| Q-012 | 缺少前端错误处理统一方案 | ✅ 接受 | **修改正确** - TDD v1.1 第 10.2 节补充了前端错误处理方案，包含 API 错误、WebSocket 错误、全局未捕获错误的处理代码 | ✅ 关闭 |
| Q-013 | 数据库连接池配置未说明 | ✅ 接受 | **修改正确** - TDD v1.1 第 7.2 节补充了连接池配置代码（pool_size=5, max_overflow=15） | ✅ 关闭 |
| Q-014 | 缺少开发环境搭建指南 | ⏳ 延后 | **延后合理** - 开发环境搭建指南不属于 TDD 范畴，计划在编码阶段编写 README.md | ✅ 关闭 |
| Q-015 | 脚本执行引擎缺少并发控制说明 | ✅ 接受 | **修改正确** - TDD v1.1 第 11.4 节新增"并发控制配置"，包含 Celery Worker 配置和任务并发限制 | ✅ 关闭 |

**建议问题结论**: ✅ 所有 6 个建议问题已妥善处理

---

## TDD v1.1 修改验证

| 章节 | 修改内容 | 验证结果 |
|------|---------|---------|
| 1.2 设计原则 | 新增"脚本沙箱执行"、"断点续测" | ✅ 已验证 |
| 2.1 架构图 | 新增"沙箱隔离器"组件 | ✅ 已验证 |
| 2.3 部署架构 | 新增 Celery Beat 组件 | ✅ 已验证 |
| 2.4 可用性保障设计 | 新增备份策略、健康检查、故障恢复 | ✅ 已验证 |
| 3.2.1 任务模块 API | 新增 `/resume` 接口 | ✅ 已验证 |
| 3.2.2 用例模块 API | 补充分类管理 API 详细定义、软删除说明 | ✅ 已验证 |
| 3.4 容错与恢复机制 | 新增断点续测、重试策略、状态机 | ✅ 已验证 |
| 4.2.3 cases 表 | 新增 `is_deleted`、`deleted_at` 字段 | ✅ 已验证 |
| 4.2.5 task_results 表 | 新增 `retry_count` 字段 | ✅ 已验证 |
| 4.2.6 audit_logs 表 | 新增完整 DDL 定义 | ✅ 已验证 |
| 4.3 数据生命周期管理 | 新增数据保留策略、定时清理任务 | ✅ 已验证 |
| 5.1 API 规范 | 新增 WebSocket 认证方式说明 | ✅ 已验证 |
| 7.2 优化策略 | 新增数据库连接池配置 | ✅ 已验证 |
| 10.2 前端错误处理方案 | 新增全局错误处理代码 | ✅ 已验证 |
| 11.3 脚本安全执行机制 | 新增用户隔离、资源限制、白名单校验 | ✅ 已验证 |
| 11.4 并发控制配置 | 新增 Celery Worker 配置、任务并发限制 | ✅ 已验证 |

---

## 需求覆盖度复核

| 需求ID | 需求名称 | TDD v1.1 覆盖情况 | 备注 |
|--------|---------|------------------|------|
| F-001 | 目标地址输入 | ✅ 完全覆盖 | API 设计中包含 target_ip 参数 |
| F-002 | 检测用例选择 | ✅ 完全覆盖 | API 设计中包含 case_ids 参数 |
| F-003 | 任务执行控制 | ✅ 完全覆盖 | 包含 start/stop/resume 接口，超时机制，中断策略 |
| F-004 | 实时状态反馈 | ✅ 完全覆盖 | WebSocket 实时推送设计，含认证机制 |
| F-005 | 用例新增与编辑 | ✅ 完全覆盖 | 用例 CRUD API，含软删除 |
| F-006 | 用例分类管理 | ✅ 完全覆盖 | 分类管理 API 详细定义 |
| F-007 | 检测结果展示 | ✅ 完全覆盖 | 结果 API + 日志保留 30 天策略 |
| F-008 | 报告导出 | ✅ 完全覆盖 | PDF/HTML 导出接口 |
| F-009 | 用户认证 | ✅ 完全覆盖 | JWT 认证设计完整 |
| F-010 | 账号管理 | ✅ 完全覆盖 | 用户管理 API |
| F-011 | 历史记录查询 | ✅ 完全覆盖 | 历史任务 API + 保留 90 天策略 |
| SRS 4.2 | 可用性需求 | ✅ 完全覆盖 | 备份策略、健康检查、故障恢复 |
| SRS 4.3 | 安全需求 | ✅ 完全覆盖 | 审计日志、脚本安全执行 |
| SRS R-003 | 脚本安全风险 | ✅ 完全覆盖 | 沙箱隔离、资源限制、白名单 |
| SRS R-004 | 网络不稳定风险 | ✅ 完全覆盖 | 断点续测、重试机制 |

---

## 延后问题跟踪确认

| 问题ID | 问题描述 | 计划处理时间 | 跟踪方式 | 确认状态 |
|--------|---------|-------------|---------|---------|
| Q-010 | API 版本演进策略 | v2.0 前 | 技术债务清单 | ✅ 已确认跟踪 |
| Q-011 | 监控告警设计 | 预发布阶段 | 运维文档待办 | ✅ 已确认跟踪 |
| Q-014 | 开发环境搭建指南 | 编码开发阶段 | README.md | ✅ 已确认跟踪 |

---

## 最终评审结论

- [x] ✅ **通过** - 所有阻塞问题已解决，TDD v1.1 确认为设计基线
- [ ] ⚠️ 条件通过 - 有遗留问题，需在开发阶段前处理
- [ ] ❌ 不通过 - 有重大分歧，需升级决策

---

## 评审总结

1. **阻塞问题**: 3 个阻塞问题全部正确解决，修改内容完整且符合需求
2. **重要问题**: 5 个接受修改均已正确实施，1 个拒绝理由合理
3. **建议问题**: 4 个接受修改均已正确实施，3 个延后处理均有明确跟踪计划
4. **需求覆盖**: TDD v1.1 完全覆盖 SRS v1.1 所有功能需求和非功能需求
5. **设计质量**: 设计文档结构清晰、内容完整、技术方案可行

---

## 设计基线

- **基线版本**: TDD v1.1
- **基线日期**: 2026-01-28
- **变更控制**: 后续修改需走设计变更流程

---

## 签字确认

| 角色 | 姓名 | 意见 | 签字 | 日期 |
|------|------|------|------|------|
| 高级架构师 | | 通过 | | 2026-01-28 |
| 技术负责人 | | 待签字 | | |
| 测试负责人 | | 待签字 | | |
| 开发负责人 | | 待签字 | | |
