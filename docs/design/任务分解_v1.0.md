# 任务分解文档

> 项目名称: 自动化安全检测平台 (AutoSecDet)
> 版本: v1.0
> 创建日期: 2026-01-28
> 设计基线: TDD_v1.1
> 作者: 技术团队

---

## 1. 概述

### 1.1 任务分解目标

基于 TDD v1.1 设计文档，将系统功能分解为可执行的开发任务，确保：
- 每个任务独立可交付
- 任务粒度适中（1-3 人天）
- 任务依赖关系清晰
- 工期估算合理

### 1.2 模块划分

| 模块 | 说明 | 优先级 |
|------|------|--------|
| 基础设施 | 项目初始化、数据库、Docker 配置 | P0 |
| 后端-认证模块 | 用户认证、JWT、权限控制 | P0 |
| 后端-用例模块 | 用例 CRUD、分类管理 | P0 |
| 后端-任务模块 | 任务创建、执行、状态管理 | P0 |
| 后端-报告模块 | 结果查询、报告导出 | P1 |
| 后端-脚本引擎 | 脚本执行、沙箱隔离 | P0 |
| 前端-基础框架 | 项目初始化、路由、状态管理 | P0 |
| 前端-认证模块 | 登录页面、权限控制 | P0 |
| 前端-任务模块 | 任务创建、执行、实时状态 | P0 |
| 前端-用例模块 | 用例列表、编辑、分类管理 | P1 |
| 前端-报告模块 | 结果展示、报告导出 | P1 |
| 集成测试 | 端到端测试、性能测试 | P1 |
| 部署运维 | Docker 部署、文档编写 | P2 |

---

## 2. 任务清单 (Backlog)

### 2.1 基础设施模块

---

#### TASK-001: 后端项目初始化

**所属模块**: 基础设施
**负责人**: 后端开发
**预估工时**: 1 人天
**优先级**: P0

**任务描述**:
初始化 Python 后端项目，配置 FastAPI 框架、项目结构、依赖管理。

**验收标准**:
- [ ] 创建 backend/ 目录结构（参考 TDD 第 10 节）
- [ ] 配置 requirements.txt，包含 FastAPI、SQLAlchemy、Celery 等依赖
- [ ] 实现基础 main.py，启动 FastAPI 应用
- [ ] 配置 CORS、日志、环境变量读取
- [ ] 实现 /health 健康检查接口

**依赖任务**: 无

**技术要点**:
- FastAPI 0.100+
- Python 3.11+
- 使用 pydantic-settings 管理配置

---

#### TASK-002: 数据库初始化与迁移

**所属模块**: 基础设施
**负责人**: 后端开发
**预估工时**: 1.5 人天
**优先级**: P0

**任务描述**:
配置 PostgreSQL 数据库连接，创建所有数据表，配置 Alembic 迁移工具。

**验收标准**:
- [ ] 配置 SQLAlchemy 数据库连接（连接池 min=5, max=20）
- [ ] 创建所有数据模型（users, categories, cases, tasks, task_results, audit_logs）
- [ ] 配置 Alembic 迁移工具
- [ ] 创建初始迁移脚本
- [ ] 创建数据库索引

**依赖任务**: TASK-001

**技术要点**:
- SQLAlchemy 2.x
- Alembic 迁移
- 参考 TDD 第 4.2 节表结构设计

---

#### TASK-003: Redis 与 Celery 配置

**所属模块**: 基础设施
**负责人**: 后端开发
**预估工时**: 1 人天
**优先级**: P0

**任务描述**:
配置 Redis 连接、Celery 任务队列、Celery Beat 定时任务。

**验收标准**:
- [ ] 配置 Redis 连接
- [ ] 配置 Celery 应用（worker_concurrency=4）
- [ ] 配置 Celery Beat 定时任务（日志清理、数据归档）
- [ ] 实现示例异步任务验证配置正确

**依赖任务**: TASK-001

**技术要点**:
- Celery 5.x
- Redis 7.x
- 参考 TDD 第 4.3 节数据生命周期管理

---

#### TASK-004: Docker Compose 配置

**所属模块**: 基础设施
**负责人**: 后端开发
**预估工时**: 1 人天
**优先级**: P0

**任务描述**:
配置 Docker Compose 开发环境，包含所有服务容器。

**验收标准**:
- [ ] 创建 docker-compose.yml
- [ ] 配置 PostgreSQL 容器
- [ ] 配置 Redis 容器
- [ ] 配置 Backend 容器（含 healthcheck）
- [ ] 配置数据卷挂载
- [ ] 编写 docker-compose up 一键启动脚本

**依赖任务**: TASK-001, TASK-002, TASK-003

**技术要点**:
- Docker Compose
- 参考 TDD 第 2.3 节部署架构

---

### 2.2 后端-认证模块

---

#### TASK-005: 用户模型与密码加密

**所属模块**: 后端-认证模块
**负责人**: 后端开发
**预估工时**: 0.5 人天
**优先级**: P0

**任务描述**:
实现用户数据模型、密码 bcrypt 加密、登录锁定逻辑。

**验收标准**:
- [ ] 实现 User 模型（参考 TDD 4.2.1）
- [ ] 实现密码 bcrypt 哈希（cost factor=12）
- [ ] 实现登录失败计数和锁定逻辑（5次错误锁定30分钟）

**依赖任务**: TASK-002

**技术要点**:
- bcrypt
- 参考 TDD 第 6.1 节认证授权

---

#### TASK-006: JWT 认证实现

**所属模块**: 后端-认证模块
**负责人**: 后端开发
**预估工时**: 1 人天
**优先级**: P0

**任务描述**:
实现 JWT Token 生成、验证、刷新机制。

**验收标准**:
- [ ] 实现 Access Token 生成（30分钟有效期）
- [ ] 实现 Refresh Token 生成（7天有效期）
- [ ] 实现 Token 验证中间件
- [ ] 实现 Token 刷新接口

**依赖任务**: TASK-005

**技术要点**:
- python-jose
- 参考 TDD 第 6.1 节

---

#### TASK-007: 登录登出 API

**所属模块**: 后端-认证模块
**负责人**: 后端开发
**预估工时**: 1 人天
**优先级**: P0

**任务描述**:
实现用户登录、登出 API 接口。

**验收标准**:
- [ ] 实现 POST /api/v1/auth/login 接口
- [ ] 实现 POST /api/v1/auth/logout 接口
- [ ] 登录成功记录审计日志
- [ ] 登录失败记录审计日志
- [ ] 编写单元测试

**依赖任务**: TASK-006

**技术要点**:
- 参考 TDD 第 3.2.4 节用户模块 API

---

#### TASK-008: RBAC 权限控制

**所属模块**: 后端-认证模块
**负责人**: 后端开发
**预估工时**: 1 人天
**优先级**: P0

**任务描述**:
实现基于角色的访问控制（RBAC）。

**验收标准**:
- [ ] 实现权限检查装饰器
- [ ] 实现 tester 角色权限
- [ ] 实现 admin 角色权限
- [ ] 在需要权限的接口上应用装饰器

**依赖任务**: TASK-006

**技术要点**:
- FastAPI Depends
- 参考 TDD 第 6.2 节权限控制

---

#### TASK-009: 用户管理 API

**所属模块**: 后端-认证模块
**负责人**: 后端开发
**预估工时**: 1 人天
**优先级**: P1

**任务描述**:
实现用户 CRUD 管理接口（仅 admin 可访问）。

**验收标准**:
- [ ] 实现 GET /api/v1/users 用户列表
- [ ] 实现 POST /api/v1/users 创建用户
- [ ] 实现 PUT /api/v1/users/{id} 更新用户
- [ ] 实现 POST /api/v1/users/{id}/reset-password 重置密码
- [ ] 记录审计日志

**依赖任务**: TASK-008

**技术要点**:
- 参考 TDD 第 3.2.4 节

---

### 2.3 后端-用例模块

---

#### TASK-010: 分类管理 API

**所属模块**: 后端-用例模块
**负责人**: 后端开发
**预估工时**: 1 人天
**优先级**: P0

**任务描述**:
实现用例分类的 CRUD 接口。

**验收标准**:
- [ ] 实现 GET /api/v1/categories 分类列表
- [ ] 实现 POST /api/v1/categories 创建分类
- [ ] 实现 PUT /api/v1/categories/{id} 更新分类
- [ ] 实现 DELETE /api/v1/categories/{id} 删除分类（检查是否有关联用例）
- [ ] 记录审计日志

**依赖任务**: TASK-002, TASK-008

**技术要点**:
- 参考 TDD 第 3.2.2 节分类管理 API 详细定义

---

#### TASK-011: 用例 CRUD API

**所属模块**: 后端-用例模块
**负责人**: 后端开发
**预估工时**: 1.5 人天
**优先级**: P0

**任务描述**:
实现用例的 CRUD 接口，包含软删除逻辑。

**验收标准**:
- [ ] 实现 GET /api/v1/cases 用例列表（支持分页、筛选）
- [ ] 实现 GET /api/v1/cases/{id} 用例详情
- [ ] 实现 POST /api/v1/cases 创建用例
- [ ] 实现 PUT /api/v1/cases/{id} 更新用例
- [ ] 实现 DELETE /api/v1/cases/{id} 软删除用例
- [ ] 实现 POST /api/v1/cases/{id}/toggle 启用/禁用
- [ ] 记录审计日志

**依赖任务**: TASK-010

**技术要点**:
- 软删除：设置 is_deleted=true, deleted_at=now()
- 参考 TDD 第 3.2.2 节

---

### 2.4 后端-任务模块

---

#### TASK-012: 任务创建 API

**所属模块**: 后端-任务模块
**负责人**: 后端开发
**预估工时**: 1 人天
**优先级**: P0

**任务描述**:
实现检测任务创建接口。

**验收标准**:
- [ ] 实现 POST /api/v1/tasks 创建任务
- [ ] 验证目标 IP 格式
- [ ] 验证用例 ID 有效性
- [ ] 创建 task_results 记录
- [ ] 返回 task_id

**依赖任务**: TASK-011

**技术要点**:
- 参考 TDD 第 3.2.1 节任务模块 API

---

#### TASK-013: 任务执行控制 API

**所属模块**: 后端-任务模块
**负责人**: 后端开发
**预估工时**: 1.5 人天
**优先级**: P0

**任务描述**:
实现任务启动、停止、恢复接口。

**验收标准**:
- [ ] 实现 POST /api/v1/tasks/{id}/start 启动任务
- [ ] 实现 POST /api/v1/tasks/{id}/stop 停止任务
- [ ] 实现 POST /api/v1/tasks/{id}/resume 恢复任务（断点续测）
- [ ] 实现任务状态机转换逻辑
- [ ] 检查同一 IP 是否有正在执行的任务

**依赖任务**: TASK-012, TASK-003

**技术要点**:
- 参考 TDD 第 3.4 节容错与恢复机制
- 任务状态机：pending → running → completed/stopped/error

---

#### TASK-014: 任务查询 API

**所属模块**: 后端-任务模块
**负责人**: 后端开发
**预估工时**: 0.5 人天
**优先级**: P0

**任务描述**:
实现任务详情和历史列表查询接口。

**验收标准**:
- [ ] 实现 GET /api/v1/tasks/{id} 任务详情
- [ ] 实现 GET /api/v1/tasks 历史任务列表（支持分页、筛选）

**依赖任务**: TASK-012

**技术要点**:
- 参考 TDD 第 3.2.1 节

---

#### TASK-015: WebSocket 实时状态推送

**所属模块**: 后端-任务模块
**负责人**: 后端开发
**预估工时**: 1.5 人天
**优先级**: P0

**任务描述**:
实现 WebSocket 接口，推送任务执行实时状态。

**验收标准**:
- [ ] 实现 WS /ws/tasks/{task_id} WebSocket 端点
- [ ] 实现 query parameter token 认证
- [ ] 实现心跳检测机制
- [ ] 推送任务进度、当前用例状态
- [ ] 处理连接断开和重连

**依赖任务**: TASK-006, TASK-013

**技术要点**:
- FastAPI WebSocket
- 参考 TDD 第 5.1 节 WebSocket 认证方式

---

### 2.5 后端-脚本执行引擎

---

#### TASK-016: 脚本执行器基础实现

**所属模块**: 后端-脚本引擎
**负责人**: 后端开发
**预估工时**: 1.5 人天
**优先级**: P0

**任务描述**:
实现脚本执行器，支持 Python 和 Shell 脚本执行。

**验收标准**:
- [ ] 实现 PythonRunner 执行 .py 脚本
- [ ] 实现 ShellRunner 执行 .sh 脚本
- [ ] 通过环境变量传递 TARGET_IP
- [ ] 捕获 stdout、stderr、exit_code
- [ ] 根据 exit_code 判断 pass/fail

**依赖任务**: TASK-001

**技术要点**:
- subprocess.Popen
- 参考 TDD 第 11.2 节脚本规范

---

#### TASK-017: 脚本超时控制

**所属模块**: 后端-脚本引擎
**负责人**: 后端开发
**预估工时**: 0.5 人天
**优先级**: P0

**任务描述**:
实现脚本执行超时控制机制。

**验收标准**:
- [ ] 实现 5 分钟超时自动终止
- [ ] 超时后正确清理子进程
- [ ] 超时标记为 Error 状态

**依赖任务**: TASK-016

**技术要点**:
- subprocess timeout
- 参考 TDD 第 11.1 节

---

#### TASK-018: 脚本安全执行机制

**所属模块**: 后端-脚本引擎
**负责人**: 后端开发
**预估工时**: 2 人天
**优先级**: P0

**任务描述**:
实现脚本沙箱隔离和安全执行机制。

**验收标准**:
- [ ] 实现脚本执行用户隔离（script_runner 用户）
- [ ] 实现资源限制（CPU 300s、内存 512MB、文件描述符 100、进程数 10）
- [ ] 实现脚本白名单校验
- [ ] 验证脚本路径在允许目录内
- [ ] 验证脚本已在数据库注册

**依赖任务**: TASK-016

**技术要点**:
- resource 模块
- pwd 模块
- 参考 TDD 第 11.3 节脚本安全执行机制

---

#### TASK-019: Celery 任务执行器

**所属模块**: 后端-脚本引擎
**负责人**: 后端开发
**预估工时**: 2 人天
**优先级**: P0

**任务描述**:
实现 Celery 异步任务执行检测任务。

**验收标准**:
- [ ] 实现 execute_task Celery 任务
- [ ] 顺序执行所有用例
- [ ] 实现单用例重试逻辑（网络超时重试 2 次）
- [ ] 更新任务进度到 Redis
- [ ] 通过 WebSocket 推送状态
- [ ] 保存执行日志到文件

**依赖任务**: TASK-016, TASK-017, TASK-018, TASK-015

**技术要点**:
- Celery task
- 参考 TDD 第 3.4.2 节单用例重试策略
- 参考 TDD 第 11.4 节并发控制配置

---

### 2.6 后端-报告模块

---

#### TASK-020: 任务结果查询 API

**所属模块**: 后端-报告模块
**负责人**: 后端开发
**预估工时**: 1 人天
**优先级**: P1

**任务描述**:
实现任务结果详情和执行日志查询接口。

**验收标准**:
- [ ] 实现 GET /api/v1/tasks/{id}/results 结果详情
- [ ] 实现 GET /api/v1/tasks/{id}/results/{rid}/log 执行日志
- [ ] 支持按状态筛选结果

**依赖任务**: TASK-014

**技术要点**:
- 参考 TDD 第 3.2.3 节报告模块 API

---

#### TASK-021: 报告导出功能

**所属模块**: 后端-报告模块
**负责人**: 后端开发
**预估工时**: 2 人天
**优先级**: P1

**任务描述**:
实现 PDF 和 HTML 报告导出功能。

**验收标准**:
- [ ] 实现 GET /api/v1/tasks/{id}/export/pdf PDF 导出
- [ ] 实现 GET /api/v1/tasks/{id}/export/html HTML 导出
- [ ] 报告包含任务信息、统计数据、详细结果
- [ ] PDF 样式美观

**依赖任务**: TASK-020

**技术要点**:
- WeasyPrint
- Jinja2 模板
- 参考 TDD 第 3.2.3 节

---

### 2.7 后端-审计与清理

---

#### TASK-022: 审计日志服务

**所属模块**: 后端-审计
**负责人**: 后端开发
**预估工时**: 1 人天
**优先级**: P1

**任务描述**:
实现审计日志记录服务。

**验收标准**:
- [ ] 实现 AuditLogService 服务类
- [ ] 记录登录/登出操作
- [ ] 记录用例/分类/用户的 CRUD 操作
- [ ] 记录 IP 地址和 User-Agent

**依赖任务**: TASK-002

**技术要点**:
- 参考 TDD 第 4.2.6 节 audit_logs 表

---

#### TASK-023: 定时清理任务

**所属模块**: 后端-清理
**负责人**: 后端开发
**预估工时**: 1 人天
**优先级**: P1

**任务描述**:
实现 Celery Beat 定时清理任务。

**验收标准**:
- [ ] 实现 cleanup_expired_logs 任务（清理 30 天前日志）
- [ ] 实现 cleanup_expired_tasks 任务（清理 90 天前任务）
- [ ] 实现 archive_audit_logs 任务（归档 180 天前审计日志）
- [ ] 配置 Celery Beat 调度

**依赖任务**: TASK-003

**技术要点**:
- Celery Beat
- 参考 TDD 第 4.3 节数据生命周期管理

---

### 2.8 前端-基础框架

---

#### TASK-024: 前端项目初始化

**所属模块**: 前端-基础框架
**负责人**: 前端开发
**预估工时**: 1 人天
**优先级**: P0

**任务描述**:
初始化 React + TypeScript 前端项目。

**验收标准**:
- [ ] 使用 Vite 创建 React + TypeScript 项目
- [ ] 配置 TailwindCSS
- [ ] 配置 shadcn/ui 组件库
- [ ] 配置 Lucide Icons
- [ ] 创建目录结构（参考 TDD 第 10 节）

**依赖任务**: 无

**技术要点**:
- React 18
- TypeScript 5.x
- TailwindCSS 3.x
- shadcn/ui

---

#### TASK-025: 路由与布局配置

**所属模块**: 前端-基础框架
**负责人**: 前端开发
**预估工时**: 1 人天
**优先级**: P0

**任务描述**:
配置前端路由和基础布局组件。

**验收标准**:
- [ ] 配置 React Router
- [ ] 实现主布局组件（侧边栏、顶部导航）
- [ ] 实现路由守卫（登录检查）
- [ ] 配置路由表

**依赖任务**: TASK-024

**技术要点**:
- React Router v6

---

#### TASK-026: 状态管理与 API 服务

**所属模块**: 前端-基础框架
**负责人**: 前端开发
**预估工时**: 1 人天
**优先级**: P0

**任务描述**:
配置 Zustand 状态管理和 Axios API 服务。

**验收标准**:
- [ ] 配置 Zustand 状态管理
- [ ] 配置 Axios 实例（baseURL、拦截器）
- [ ] 实现 Token 自动附加
- [ ] 实现全局错误处理（参考 TDD 第 10.2 节）
- [ ] 实现 401 自动跳转登录

**依赖任务**: TASK-024

**技术要点**:
- Zustand 4.x
- Axios
- 参考 TDD 第 10.2 节前端错误处理方案

---

### 2.9 前端-认证模块

---

#### TASK-027: 登录页面

**所属模块**: 前端-认证模块
**负责人**: 前端开发
**预估工时**: 1 人天
**优先级**: P0

**任务描述**:
实现用户登录页面。

**验收标准**:
- [ ] 实现登录表单（用户名、密码）
- [ ] 实现表单验证
- [ ] 调用登录 API
- [ ] 存储 Token 到 localStorage
- [ ] 登录成功跳转首页
- [ ] 显示登录错误信息

**依赖任务**: TASK-026, TASK-007

**技术要点**:
- React Hook Form
- shadcn/ui Form 组件

---

#### TASK-028: 用户状态管理

**所属模块**: 前端-认证模块
**负责人**: 前端开发
**预估工时**: 0.5 人天
**优先级**: P0

**任务描述**:
实现用户状态管理 Store。

**验收标准**:
- [ ] 实现 useAuthStore（user、token、login、logout）
- [ ] 实现 Token 持久化
- [ ] 实现角色权限判断方法

**依赖任务**: TASK-026

**技术要点**:
- Zustand persist

---

### 2.10 前端-任务模块

---

#### TASK-029: 任务创建页面

**所属模块**: 前端-任务模块
**负责人**: 前端开发
**预估工时**: 2 人天
**优先级**: P0

**任务描述**:
实现检测任务创建页面。

**验收标准**:
- [ ] 实现目标 IP 输入框（带格式验证）
- [ ] 实现用例选择列表（按分类分组、支持全选/反选）
- [ ] 实现用例搜索筛选
- [ ] 显示已选用例数量
- [ ] 调用创建任务 API
- [ ] 创建成功跳转任务详情页

**依赖任务**: TASK-026, TASK-012

**技术要点**:
- 参考 SRS F-001、F-002

---

#### TASK-030: 任务执行页面

**所属模块**: 前端-任务模块
**负责人**: 前端开发
**预估工时**: 2.5 人天
**优先级**: P0

**任务描述**:
实现任务执行控制和实时状态展示页面。

**验收标准**:
- [ ] 显示任务基本信息（目标 IP、创建时间）
- [ ] 实现启动/停止/恢复按钮
- [ ] 实现 WebSocket 连接
- [ ] 实时显示执行进度（进度条、百分比）
- [ ] 实时显示当前执行用例
- [ ] 显示用例执行结果列表（Pass/Fail/Error 状态）
- [ ] 实现 WebSocket 断线重连

**依赖任务**: TASK-029, TASK-015

**技术要点**:
- WebSocket
- 参考 SRS F-003、F-004

---

#### TASK-031: 任务历史列表页面

**所属模块**: 前端-任务模块
**负责人**: 前端开发
**预估工时**: 1 人天
**优先级**: P1

**任务描述**:
实现历史任务列表页面。

**验收标准**:
- [ ] 显示任务列表（表格形式）
- [ ] 显示任务状态、目标 IP、执行时间、通过率
- [ ] 实现分页
- [ ] 实现按状态/IP/时间筛选
- [ ] 点击跳转任务详情

**依赖任务**: TASK-026, TASK-014

**技术要点**:
- 参考 SRS F-011

---

### 2.11 前端-用例模块

---

#### TASK-032: 用例列表页面

**所属模块**: 前端-用例模块
**负责人**: 前端开发
**预估工时**: 1.5 人天
**优先级**: P1

**任务描述**:
实现用例列表页面。

**验收标准**:
- [ ] 显示用例列表（表格形式）
- [ ] 显示用例名称、分类、风险等级、状态
- [ ] 实现分页
- [ ] 实现按分类/风险等级/状态筛选
- [ ] 实现搜索功能
- [ ] 管理员显示编辑/删除按钮

**依赖任务**: TASK-026, TASK-011

**技术要点**:
- 虚拟列表（大量用例时）
- 参考 SRS F-005

---

#### TASK-033: 用例编辑页面

**所属模块**: 前端-用例模块
**负责人**: 前端开发
**预估工时**: 1.5 人天
**优先级**: P1

**任务描述**:
实现用例新增和编辑页面（仅管理员）。

**验收标准**:
- [ ] 实现用例表单（名称、分类、风险等级、描述、修复建议、脚本路径）
- [ ] 实现表单验证
- [ ] 支持新增和编辑模式
- [ ] 调用创建/更新 API

**依赖任务**: TASK-032

**技术要点**:
- 参考 SRS F-005

---

#### TASK-034: 分类管理页面

**所属模块**: 前端-用例模块
**负责人**: 前端开发
**预估工时**: 1 人天
**优先级**: P1

**任务描述**:
实现用例分类管理页面（仅管理员）。

**验收标准**:
- [ ] 显示分类列表
- [ ] 实现新增/编辑/删除分类
- [ ] 显示每个分类下的用例数量
- [ ] 删除时检查是否有关联用例

**依赖任务**: TASK-026, TASK-010

**技术要点**:
- 参考 SRS F-006

---

### 2.12 前端-报告模块

---

#### TASK-035: 结果详情页面

**所属模块**: 前端-报告模块
**负责人**: 前端开发
**预估工时**: 1.5 人天
**优先级**: P1

**任务描述**:
实现任务结果详情页面。

**验收标准**:
- [ ] 显示任务统计信息（通过/失败/错误数量、通过率）
- [ ] 显示结果列表（用例名称、状态、执行时间）
- [ ] 按状态筛选（全部/通过/失败/错误）
- [ ] 点击查看执行日志
- [ ] 显示修复建议（失败用例）

**依赖任务**: TASK-030, TASK-020

**技术要点**:
- 参考 SRS F-007

---

#### TASK-036: 报告导出功能

**所属模块**: 前端-报告模块
**负责人**: 前端开发
**预估工时**: 0.5 人天
**优先级**: P1

**任务描述**:
实现报告导出功能。

**验收标准**:
- [ ] 实现导出 PDF 按钮
- [ ] 实现导出 HTML 按钮
- [ ] 调用导出 API 并下载文件

**依赖任务**: TASK-035, TASK-021

**技术要点**:
- 文件下载
- 参考 SRS F-008

---

### 2.13 前端-系统管理

---

#### TASK-037: 用户管理页面

**所属模块**: 前端-系统管理
**负责人**: 前端开发
**预估工时**: 1.5 人天
**优先级**: P1

**任务描述**:
实现用户管理页面（仅管理员）。

**验收标准**:
- [ ] 显示用户列表
- [ ] 实现新增用户
- [ ] 实现编辑用户（角色、状态）
- [ ] 实现重置密码

**依赖任务**: TASK-026, TASK-009

**技术要点**:
- 参考 SRS F-010

---

### 2.14 集成测试

---

#### TASK-038: API 集成测试

**所属模块**: 集成测试
**负责人**: 测试开发
**预估工时**: 2 人天
**优先级**: P1

**任务描述**:
编写后端 API 集成测试。

**验收标准**:
- [ ] 编写认证模块测试用例
- [ ] 编写用例模块测试用例
- [ ] 编写任务模块测试用例
- [ ] 测试覆盖率 ≥ 60%

**依赖任务**: 所有后端任务

**技术要点**:
- pytest
- httpx

---

#### TASK-039: 端到端测试

**所属模块**: 集成测试
**负责人**: 测试开发
**预估工时**: 2 人天
**优先级**: P1

**任务描述**:
编写端到端测试用例。

**验收标准**:
- [ ] 编写登录流程测试
- [ ] 编写任务创建和执行流程测试
- [ ] 编写用例管理流程测试
- [ ] 编写报告导出流程测试

**依赖任务**: 所有前后端任务

**技术要点**:
- Playwright

---

### 2.15 部署运维

---

#### TASK-040: 生产环境 Docker 配置

**所属模块**: 部署运维
**负责人**: 运维开发
**预估工时**: 1 人天
**优先级**: P2

**任务描述**:
配置生产环境 Docker 部署。

**验收标准**:
- [ ] 配置 Nginx 反向代理
- [ ] 配置 HTTPS（TLS 1.2+）
- [ ] 配置生产环境 docker-compose.prod.yml
- [ ] 配置数据库备份脚本

**依赖任务**: TASK-004

**技术要点**:
- 参考 TDD 第 2.3、2.4 节

---

#### TASK-041: 项目文档编写

**所属模块**: 部署运维
**负责人**: 技术负责人
**预估工时**: 1 人天
**优先级**: P2

**任务描述**:
编写项目 README 和部署文档。

**验收标准**:
- [ ] 编写 README.md（项目介绍、快速开始）
- [ ] 编写开发环境搭建指南
- [ ] 编写部署文档
- [ ] 编写 API 文档说明

**依赖任务**: 所有任务

**技术要点**:
- Markdown

---

## 3. 开发排期计划

### 3.1 里程碑节点

| 里程碑 | 目标 | 计划完成日期 | 包含任务 |
|--------|------|-------------|---------|
| M1 | 基础设施就绪 | 第 1 周末 | TASK-001 ~ TASK-004 |
| M2 | 后端核心功能完成 | 第 3 周末 | TASK-005 ~ TASK-023 |
| M3 | 前端核心功能完成 | 第 5 周末 | TASK-024 ~ TASK-037 |
| M4 | 集成测试通过 | 第 6 周末 | TASK-038 ~ TASK-039 |
| M5 | 部署上线 | 第 7 周末 | TASK-040 ~ TASK-041 |

### 3.2 开发排期甘特图

```
Week 1:  ████████████████████████████████████████
         TASK-001 ████
         TASK-002 ████████
         TASK-003 ████
         TASK-004     ████
         TASK-024         ████

Week 2:  ████████████████████████████████████████
         TASK-005 ██
         TASK-006 ████
         TASK-007     ████
         TASK-008         ████
         TASK-025             ████
         TASK-026                 ████

Week 3:  ████████████████████████████████████████
         TASK-009 ████
         TASK-010     ████
         TASK-011         ██████
         TASK-012             ████
         TASK-027                 ████
         TASK-028                     ██

Week 4:  ████████████████████████████████████████
         TASK-013 ██████
         TASK-014     ██
         TASK-015         ██████
         TASK-016             ██████
         TASK-029                 ████████

Week 5:  ████████████████████████████████████████
         TASK-017 ██
         TASK-018     ████████
         TASK-019             ████████
         TASK-030                     ██████████

Week 6:  ████████████████████████████████████████
         TASK-020 ████
         TASK-021     ████████
         TASK-022             ████
         TASK-023                 ████
         TASK-031                     ████
         TASK-032                         ██████

Week 7:  ████████████████████████████████████████
         TASK-033 ██████
         TASK-034     ████
         TASK-035         ██████
         TASK-036             ██
         TASK-037                 ██████

Week 8:  ████████████████████████████████████████
         TASK-038 ████████
         TASK-039         ████████
         TASK-040                 ████
         TASK-041                     ████
```

### 3.3 资源分配表

| 角色 | 人数 | 负责任务 |
|------|------|---------|
| 后端开发 | 2 | TASK-001 ~ TASK-023 |
| 前端开发 | 1 | TASK-024 ~ TASK-037 |
| 测试开发 | 1 | TASK-038 ~ TASK-039 |
| 运维开发 | 0.5 | TASK-040 ~ TASK-041 |

---

## 4. 任务依赖关系

```
TASK-001 (后端初始化)
    │
    ├──> TASK-002 (数据库) ──> TASK-005 (用户模型) ──> TASK-006 (JWT)
    │                                                      │
    │                                                      ├──> TASK-007 (登录API)
    │                                                      │
    │                                                      └──> TASK-008 (RBAC) ──> TASK-009 (用户管理)
    │                                                                   │
    │                                                                   └──> TASK-010 (分类) ──> TASK-011 (用例)
    │                                                                                               │
    │                                                                                               └──> TASK-012 (任务创建)
    │
    ├──> TASK-003 (Redis/Celery) ──> TASK-013 (任务控制) ──> TASK-015 (WebSocket)
    │                                                              │
    │                                                              └──> TASK-019 (Celery执行器)
    │
    └──> TASK-016 (脚本执行器) ──> TASK-017 (超时) ──> TASK-018 (安全) ──> TASK-019

TASK-024 (前端初始化)
    │
    ├──> TASK-025 (路由布局)
    │
    └──> TASK-026 (状态管理) ──> TASK-027 (登录页) ──> TASK-028 (用户状态)
                                                          │
                                                          └──> TASK-029 (任务创建) ──> TASK-030 (任务执行)
                                                                                            │
                                                                                            └──> TASK-035 (结果详情)
```

---

## 5. 工时统计

| 模块 | 任务数 | 总工时 (人天) |
|------|--------|--------------|
| 基础设施 | 4 | 4.5 |
| 后端-认证模块 | 5 | 4.5 |
| 后端-用例模块 | 2 | 2.5 |
| 后端-任务模块 | 4 | 4.5 |
| 后端-脚本引擎 | 4 | 6 |
| 后端-报告模块 | 2 | 3 |
| 后端-审计清理 | 2 | 2 |
| 前端-基础框架 | 3 | 3 |
| 前端-认证模块 | 2 | 1.5 |
| 前端-任务模块 | 3 | 5.5 |
| 前端-用例模块 | 3 | 4 |
| 前端-报告模块 | 2 | 2 |
| 前端-系统管理 | 1 | 1.5 |
| 集成测试 | 2 | 4 |
| 部署运维 | 2 | 2 |
| **合计** | **41** | **50.5** |

---

## 6. 检查清单

- [x] 所有需求都已分解为任务
- [x] 任务粒度合理 (0.5-2.5 人天)
- [x] 任务依赖关系已标注
- [x] 工期估算合理
- [x] 资源分配均衡
- [x] 关键路径已识别
- [x] 里程碑节点已定义

---

## 签字确认

| 角色 | 姓名 | 签字 | 日期 |
|------|------|------|------|
| 技术负责人 | | | |
| 项目经理 | | | |
| 开发负责人 | | | |
