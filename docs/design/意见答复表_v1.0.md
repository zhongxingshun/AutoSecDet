# 技术设计评审意见答复表

> 项目名称: 自动化安全检测平台 (AutoSecDet)
> 设计文档版本: TDD v1.0 → v1.1
> 答复日期: 2026-01-28
> 答复人: 技术团队

---

## 基本信息

| 项目 | 内容 |
|------|------|
| 评审记录版本 | 评审记录_v1.0 |
| 原设计文档 | TDD_v1.0 |
| 修订后文档 | TDD_v1.1 |
| 答复日期 | 2026-01-28 |

---

## 🔴 阻塞问题答复

### Q-001: 缺少日志保留与清理机制设计

- **评审意见**: SRS F-007 要求"执行日志保留 30 天"，SRS F-011 要求"历史记录默认保留 90 天"，但 TDD 中未设计任何数据清理策略或定时任务
- **建议修改**: 增加第 4.3 节"数据生命周期管理"，设计定时清理任务
- **答复**: ✅ 接受
- **答复理由**: 评审意见正确，数据生命周期管理是系统稳定运行的关键，需要明确设计
- **修改内容**: 
  - 新增 TDD 第 4.3 节"数据生命周期管理"
  - 设计 Celery Beat 定时任务进行日志和历史记录清理
  - 明确日志保留 30 天、历史记录保留 90 天的清理策略
- **对应章节**: TDD v1.1 第 4.3 节

---

### Q-002: 缺少脚本安全执行机制

- **评审意见**: SRS 4.3 安全需求要求"脚本安全"，SRS R-003 风险识别提到"脚本审核机制、沙箱执行"，但 TDD 第 11 节未设计任何沙箱隔离或权限限制机制
- **建议修改**: 在第 11 节增加脚本安全执行设计
- **答复**: ✅ 接受
- **答复理由**: 脚本安全执行是系统安全的核心，必须设计完善的隔离和限制机制
- **修改内容**:
  - 新增 TDD 第 11.3 节"脚本安全执行机制"
  - 设计脚本执行用户隔离（专用低权限用户）
  - 设计资源限制（CPU/内存/执行时间）
  - 设计脚本白名单校验机制
- **对应章节**: TDD v1.1 第 11.3 节

---

### Q-003: 缺少断点续测/重试机制设计

- **评审意见**: SRS R-004 风险识别要求"断点续测、重试机制"以应对网络不稳定，但 TDD 中完全未涉及此设计
- **建议修改**: 在第 3.3 节任务执行流程中增加恢复和重试机制
- **答复**: ✅ 接受
- **答复理由**: 网络不稳定是实际使用中的常见问题，需要设计容错机制
- **修改内容**:
  - 新增 TDD 第 3.4 节"容错与恢复机制"
  - 设计任务中断后的恢复机制（从断点继续执行）
  - 设计单用例执行失败的重试策略（最多重试 2 次）
- **对应章节**: TDD v1.1 第 3.4 节

---

## 🟡 重要问题答复

### Q-004: 审计日志表设计不完整

- **评审意见**: `audit_logs` 表仅有 ER 图示意，缺少完整的 DDL 定义
- **建议修改**: 在第 4.2 节补充完整 SQL 定义
- **答复**: ✅ 接受
- **答复理由**: 审计日志是安全合规的重要组成部分，需要完整设计
- **修改内容**: 在 TDD 第 4.2 节补充 `audit_logs` 表的完整 DDL，包括字段类型、索引设计
- **对应章节**: TDD v1.1 第 4.2.6 节

---

### Q-005: 用例删除接口设计与需求不符

- **评审意见**: SRS F-005 仅要求"新增和编辑"用例，未提及删除功能；但 TDD 定义了删除接口
- **建议修改**: 确认是否需要删除功能
- **答复**: ✅ 接受（保留删除功能，但改为软删除）
- **答复理由**: 
  - 用例管理实际业务中需要删除功能（如废弃的用例）
  - 但为保证数据完整性和可追溯性，采用软删除方式
  - 建议后续在 SRS 中补充此需求
- **修改内容**: 
  - 保留删除接口，但改为软删除（设置 `is_deleted` 标志）
  - 在 cases 表增加 `is_deleted` 和 `deleted_at` 字段
- **对应章节**: TDD v1.1 第 3.2.2 节、第 4.2.3 节

---

### Q-006: WebSocket 认证机制未说明

- **评审意见**: WebSocket 接口未说明如何进行身份认证
- **建议修改**: 在第 5.1 节补充 WebSocket 认证方式
- **答复**: ✅ 接受
- **答复理由**: WebSocket 认证是安全设计的必要组成部分
- **修改内容**: 在 TDD 第 5.1 节补充 WebSocket 认证方式（通过 query parameter 传递 token）
- **对应章节**: TDD v1.1 第 5.1 节

---

### Q-007: 缺少系统可用性保障设计

- **评审意见**: SRS 4.2 要求"系统可用性 99%"、"故障恢复时间 < 1小时"，但 TDD 未设计高可用或故障恢复机制
- **建议修改**: 在第 2.3 节部署架构中补充相关设计
- **答复**: ✅ 接受
- **答复理由**: 可用性保障是生产环境的基本要求
- **修改内容**:
  - 在 TDD 第 2.3 节补充数据库备份策略（每日全量 + 实时 WAL）
  - 补充服务健康检查（Docker healthcheck + Nginx upstream check）
  - 补充故障恢复流程
- **对应章节**: TDD v1.1 第 2.4 节

---

### Q-008: 分类管理 API 定义过于简略

- **评审意见**: `/api/v1/categories` 仅用一行概括，缺少详细定义
- **建议修改**: 补充各接口的详细定义
- **答复**: ✅ 接受
- **答复理由**: API 文档应当完整清晰
- **修改内容**: 在 TDD 第 3.2.2 节补充分类管理各接口的详细定义
- **对应章节**: TDD v1.1 第 3.2.2 节

---

### Q-009: 缺少前端状态管理方案说明

- **评审意见**: 目录结构中有 `stores/` 目录，但未说明使用何种状态管理方案
- **建议修改**: 在第 9 节技术选型中补充
- **答复**: ❌ 拒绝（已在 TDD v1.0 中说明）
- **答复理由**: TDD v1.0 第 9.1 节技术栈总览中已明确"状态管理: Zustand 4.x - 轻量级，API 简洁"
- **备注**: 评审人可能遗漏了此内容，无需修改

---

## 🟢 建议问题答复

### Q-010: 缺少 API 版本演进策略

- **评审意见**: 建议补充 API 版本管理策略
- **答复**: ⏳ 延后
- **答复理由**: 当前为 v1.0 首版，版本演进策略可在后续迭代中完善
- **跟踪**: 记录到技术债务清单，计划在 v2.0 前完善

---

### Q-011: 缺少监控告警设计

- **评审意见**: 建议增加监控与告警设计
- **答复**: ⏳ 延后
- **答复理由**: 监控告警属于运维层面，可在部署阶段单独设计
- **跟踪**: 记录到运维文档待办，计划在预发布阶段完善

---

### Q-012: 缺少前端错误处理统一方案

- **评审意见**: 建议补充全局错误处理机制
- **答复**: ✅ 接受
- **答复理由**: 统一错误处理是良好用户体验的基础
- **修改内容**: 在 TDD 第 10 节目录结构说明中补充前端错误处理方案
- **对应章节**: TDD v1.1 第 10.2 节

---

### Q-013: 数据库连接池配置未说明

- **评审意见**: 建议明确连接池大小配置
- **答复**: ✅ 接受
- **答复理由**: 明确配置有助于性能调优
- **修改内容**: 在 TDD 第 7.2 节补充连接池配置建议（min=5, max=20）
- **对应章节**: TDD v1.1 第 7.2 节

---

### Q-014: 缺少开发环境搭建指南

- **评审意见**: 建议提供本地开发环境搭建步骤
- **答复**: ⏳ 延后
- **答复理由**: 开发环境搭建指南属于开发文档，不属于 TDD 范畴
- **跟踪**: 计划在编码开发阶段编写 README.md

---

### Q-015: 脚本执行引擎缺少并发控制说明

- **评审意见**: 未说明同时执行多个脚本时的并发控制策略
- **答复**: ✅ 接受
- **答复理由**: 并发控制是系统稳定性的重要因素
- **修改内容**: 在 TDD 第 11 节补充 Celery worker 并发配置说明
- **对应章节**: TDD v1.1 第 11.4 节

---

## 答复统计

| 答复类型 | 数量 | 占比 |
|---------|------|------|
| ✅ 接受 | 11 | 73.3% |
| ❌ 拒绝 | 1 | 6.7% |
| ⏳ 延后 | 3 | 20.0% |
| 💬 讨论 | 0 | 0% |
| **合计** | **15** | **100%** |

---

## 修改对照表

| 章节 | 修改类型 | 修改内容 | 对应问题 |
|------|---------|---------|---------|
| 2.4 | 新增 | 可用性保障设计（备份、健康检查、故障恢复） | Q-007 |
| 3.2.2 | 补充 | 分类管理 API 详细定义 | Q-008 |
| 3.2.2 | 修改 | 用例删除改为软删除 | Q-005 |
| 3.4 | 新增 | 容错与恢复机制（断点续测、重试策略） | Q-003 |
| 4.2.3 | 补充 | cases 表增加 is_deleted、deleted_at 字段 | Q-005 |
| 4.2.6 | 补充 | audit_logs 表完整 DDL 定义 | Q-004 |
| 4.3 | 新增 | 数据生命周期管理（日志清理、历史记录清理） | Q-001 |
| 5.1 | 补充 | WebSocket 认证方式说明 | Q-006 |
| 7.2 | 补充 | 数据库连接池配置建议 | Q-013 |
| 10.2 | 补充 | 前端错误处理方案 | Q-012 |
| 11.3 | 新增 | 脚本安全执行机制 | Q-002 |
| 11.4 | 新增 | 并发控制配置说明 | Q-015 |

---

## 延后问题跟踪

| 问题ID | 问题描述 | 计划处理时间 | 跟踪方式 |
|--------|---------|-------------|---------|
| Q-010 | API 版本演进策略 | v2.0 前 | 技术债务清单 |
| Q-011 | 监控告警设计 | 预发布阶段 | 运维文档待办 |
| Q-014 | 开发环境搭建指南 | 编码开发阶段 | README.md |

---

## 签字确认

| 角色 | 姓名 | 日期 |
|------|------|------|
| 答复人 | 技术团队 | 2026-01-28 |
